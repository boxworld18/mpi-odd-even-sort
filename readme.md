# MPI Odd-even Sort



## 简介

* 在 MPI 进程**只能向其相邻进程发送消息**的情况下，完成奇偶排序算法。



## 运行方法

* 直接运行下面的指令即可：

  ```shell
  spack load openmpi
  make -j4
  bash run.sh ./odd_even_sort <data_size> <file>
  ```

* 您也可以自主生成数据：

  ```shell
  ./generate <number_of_elements> <file>
  ```



## 算法

1. 进程内排序。

   ```
   Process     0         1         2         3          4           5          6           7
   Value   |6 8 3 5| |9 4 1 7| |8 2 1 7| |3 5 2 9| |8 11 4 29| |34 1 4 56| |5 7 6 11| |10 9 5 2| （排序前）
   Value   |3 5 6 8| |1 4 7 9| |1 2 7 8| |2 3 5 9| |4 8 11 29| |1 4 34 56| |5 6 7 11| |2 5 9 10| （排序后）
   ```

2. 【偶数阶段】满足 (偶数，奇数) 索引的相邻进程组成进程对。

   ```
   Process      0         1           2         3            4           5            6          7
   Value   (|3 5 6 8| |1 4 7 9|) (|1 2 7 8| |2 3 5 9|) (|4 8 11 29| |1 4 34 56|) (|5 6 7 11| |2 5 9 10|) 
   ```

3. 【偶数阶段】如果偶数进程的最大值大于奇数进程的最小值，则合并、排序两个进程的序列并重新分配至进程中（元素交换）。

   ```
   Process     0           1          2         3           4           5             6          7
   Value   (|1 3 4 5   6 7 8 9|) (|1 2 2 3   5 7 8 9|) (|1 4 4 8   11 29 34 56|) (|2 5 5 6   7 9 10 11|) （合并排序）
   Value   (|1 3 4 5| |6 7 8 9|) (|1 2 2 3| |5 7 8 9|) (|1 4 4 8| |11 29 34 56|) (|2 5 5 6| |7 9 10 11|) （重新分配）
   ```

4. 【奇数阶段】满足 (奇数，偶数) 索引的相邻进程组成进程对。

   ```
   Process     0          1         2           3         4             5           6           7
   Value   |1 3 4 5| (|6 7 8 9| |1 2 2 3|) (|5 7 8 9| |1 4 4 8|) (|11 29 34 56| |2 5 5 6|) |7 9 10 11|
   ```

5. 【奇数阶段】如果奇数进程的最大值大于偶数进程的最小值，则合并、排序两个进程的序列并重新分配至进程中（元素交换）。

   ```
   Process     0          1         2           3         4           5           6             7
   Value   |1 3 4 5| (|1 2 2 3   6 7 8 9|) (|1 4 4 5   7 8 8 9|) (|2 5 5 6   11 29 34 56|) |7 9 10 11| （合并排序）
   Value   |1 3 4 5| (|1 2 2 3| |6 7 8 9|) (|1 4 4 5| |7 8 8 9|) (|2 5 5 6| |11 29 34 56|) |7 9 10 11| （重新分配）
   ```

6. 交替运行 **偶数阶段** 和 **奇数阶段**，直到两个阶段都 **没有元素交换**。